<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Î Î¿ÏÏ„Î¿Ï†ÏŒÎ»Î¹Î± ÎœÎµÏ„Î¿Ï‡ÏÎ½</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    h1 { 
      text-align: center; 
      color: #2c3e50;
      margin-bottom: 30px;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }
    .portfolio-selector {
      text-align: center;
      margin-bottom: 30px;
      padding: 15px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .portfolio-selector button {
      background-color: #7f8c8d;
      color: black;
      border: none;
      padding: 14px 28px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      margin: 0 8px;
      transition: all 0.3s ease;
      font-weight: bold;
    }
    .portfolio-selector button:hover {
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.15);
      color: black;
    }
    .portfolio-selector button.active {
      transform: translateY(-3px);
      box-shadow: 0 6px 12px rgba(0,0,0,0.2);
      color: black;
    }
    .portfolio-selector button:nth-child(1).active { 
      background: linear-gradient(135deg, #FFD700, #FFC107);
      color: black;
    }
    .portfolio-selector button:nth-child(2).active { 
      background: linear-gradient(135deg, #2196F3, #1976D2);
      color: black;
    }
    .portfolio-selector button:nth-child(3).active { 
      background: linear-gradient(135deg, #424242, #212121);
      color: white;
    }
    .portfolio-selector button:nth-child(4).active { 
      background: linear-gradient(135deg, #f39c12, #e67e22);
      color: black;
    }
    .controls {
      text-align: center;
      margin: 25px 0;
      padding: 15px;
      background: white;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .controls button {
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 15px;
      margin: 5px 8px;
      transition: all 0.3s ease;
      font-weight: bold;
    }
    .controls button.add-purchase {
      background: linear-gradient(135deg, #2ecc71, #27ae60);
    }
    .controls button.add-purchase:hover {
      background: linear-gradient(135deg, #27ae60, #219653);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(39, 174, 96, 0.3);
    }
    .controls button.add-sale {
      background: linear-gradient(135deg, #e74c3c, #c0392b);
    }
    .controls button.add-sale:hover {
      background: linear-gradient(135deg, #c0392b, #a93226);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(231, 76, 60, 0.3);
    }
    .controls button.save {
      background: linear-gradient(135deg, #3498db, #2980b9);
    }
    .controls button.save:hover {
      background: linear-gradient(135deg, #2980b9, #1c6ea4);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(52, 152, 219, 0.3);
    }
    .controls button.save-all {
      background: linear-gradient(135deg, #9b59b6, #8e44ad);
    }
    .controls button.save-all:hover {
      background: linear-gradient(135deg, #8e44ad, #7d3c98);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(155, 89, 182, 0.3);
    }
    .controls button.delete {
      background: linear-gradient(135deg, #e74c3c, #c0392b);
    }
    .controls button.delete:hover {
      background: linear-gradient(135deg, #c0392b, #a93226);
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(231, 76, 60, 0.3);
    }
    .section-title {
      font-size: 24px;
      font-weight: bold;
      color: #2c3e50;
      margin: 30px 0 20px 0;
      padding: 15px;
      border-radius: 8px;
      background: linear-gradient(135deg, #ecf0f1, #dfe6e9);
      text-align: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }
    .owner-name {
      color: black;
      font-weight: bold;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.1);
    }
    .sub-section-title {
      font-size: 22px;
      color: white;
      margin: 25px 0 15px 0;
      padding: 15px 20px;
      background: linear-gradient(135deg, #000000, #333333);
      color: white;
      border-radius: 8px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 2px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 15px;
      background: #fff;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      border-radius: 8px;
      overflow: hidden;
    }
    th, td {
      padding: 12px 10px;
      border: 1px solid #e0e0e0;
      text-align: center;
      font-size: 14px;
    }
    th { 
      background: linear-gradient(135deg, #2c3e50, #34495e); 
      color: #fff; 
      font-weight: bold;
      position: sticky;
      top: 0;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    tr:nth-child(even) {
      background-color: #f8f9fa;
    }
    tr:hover {
      background-color: #f0f7ff;
      transition: background-color 0.2s ease;
    }
    input {
      width: 95%;
      padding: 8px 6px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
      transition: all 0.3s ease;
    }
    input:focus {
      outline: none;
      border-color: #3498db;
      box-shadow: 0 0 0 3px rgba(52,152,219,0.2);
      transform: scale(1.02);
    }
    input[type="number"] {
      text-align: right;
    }
    input[type="date"] {
      text-align: center;
    }
    .commission-input {
      background-color: #fff8e1;
      border-color: #ffd54f;
      font-style: italic;
    }
    .commission-input:focus {
      border-color: #ffb300;
      box-shadow: 0 0 0 3px rgba(255, 183, 0, 0.2);
    }
    .sale-commission-input {
      background-color: #ffebee;
      border-color: #ef9a9a;
      font-style: italic;
    }
    .sale-commission-input:focus {
      border-color: #e57373;
      box-shadow: 0 0 0 3px rgba(229, 115, 115, 0.2);
    }
    .summary {
      margin-top: 30px;
      background: linear-gradient(135deg, #fff, #f8f9fa);
      padding: 25px;
      font-size: 16px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      border-radius: 10px;
    }
    .summary strong {
      color: #2c3e50;
      font-weight: bold;
    }
    .summary div {
      margin: 10px 0;
      padding: 8px;
      background: #f8f9fa;
      border-radius: 5px;
    }
    .calculations-row {
      background: linear-gradient(135deg, #2c3e50, #34495e);
      color: white;
      font-weight: bold;
    }
    .calculations-row td {
      font-size: 16px;
      font-weight: bold;
    }
    .totals-row {
      background: linear-gradient(135deg, #27ae60, #219653);
      color: white;
      font-weight: bold;
      border-top: 3px solid #2c3e50;
    }
    .totals-row td {
      font-size: 15px;
      font-weight: bold;
    }
    #chart-container {
      margin-top: 40px;
      background: white;
      padding: 25px;
      border-radius: 10px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .profit { 
      color: #27ae60; 
      font-weight: bold;
      text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }
    .loss { 
      color: #e74c3c; 
      font-weight: bold;
      text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }
    .commission-inputs {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }
    .commission-inputs input {
      width: 100%;
    }
    .hidden {
      display: none;
    }
    .message {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 25px;
      background: linear-gradient(135deg, #27ae60, #219653);
      color: white;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      font-weight: bold;
      z-index: 1000;
      animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s;
      opacity: 0;
    }
    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    @keyframes fadeOut {
      from {
        opacity: 1;
      }
      to {
        opacity: 0;
      }
    }
    .current-price-input {
      background-color: #fff8e1;
      border-color: #ffd54f;
    }
    .current-price-input:focus {
      border-color: #ffb300;
      box-shadow: 0 0 0 3px rgba(255, 183, 0, 0.2);
    }
    .dividend-input {
      background-color: #e8f5e9;
      border-color: #81c784;
    }
    .dividend-input:focus {
      border-color: #4caf50;
      box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.2);
    }
    .history-table {
      margin-top: 20px;
    }
    .history-table th {
      background: linear-gradient(135deg, #424242, #212121);
    }
    .sold-stock {
      background-color: #f8f9fa;
      opacity: 0.9;
    }
    .stock-status {
      font-size: 11px;
      padding: 2px 6px;
      border-radius: 3px;
      font-weight: bold;
      margin-left: 5px;
    }
    .status-active {
      background-color: #27ae60;
      color: white;
    }
    .status-sold {
      background-color: #e74c3c;
      color: white;
    }
    .status-partial {
      background-color: #f39c12;
      color: white;
    }
    .no-pl {
      color: #7f8c8d;
      font-style: italic;
    }
    .owner-mitsos {
      background-color: #FFD700;
      color: black;
      padding: 5px 10px;
      border-radius: 4px;
      font-weight: bold;
    }
    .owner-aderfoula {
      background-color: #2196F3;
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-weight: bold;
    }
    .owner-father {
      background-color: #424242;
      color: white;
      padding: 5px 10px;
      border-radius: 4px;
      font-weight: bold;
    }
    .fully-sold-row {
      background-color: #e74c3c !important;
      color: white !important;
      font-weight: bold;
    }
    .fully-sold-row td {
      color: white !important;
      font-weight: bold;
    }
    
    /* ÎÎ•Î‘ STYLES Î“Î™Î‘ Î¤Î™Î£ Î‘Î›Î›Î‘Î“Î•Î£ */
    
    /* Bold ÎºÎ­ÏÎ´Î·/Î¶Î·Î¼Î¯ÎµÏ‚ */
    .final-pl {
        font-size: 18px !important;
        font-weight: 900 !important;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.3) !important;
        letter-spacing: 0.5px !important;
    }

    .final-pl-profit {
        color: #00ff00 !important;
        background-color: rgba(0, 255, 0, 0.1) !important;
        padding: 5px !important;
        border-radius: 4px !important;
        font-weight: 900 !important;
        font-size: 16px !important;
    }

    .final-pl-loss {
        color: #ff4444 !important;
        background-color: rgba(255, 68, 68, 0.1) !important;
        padding: 5px !important;
        border-radius: 4px !important;
        font-weight: 900 !important;
        font-size: 16px !important;
    }

    /* Î£Ï„Ï…Î» Î³Î¹Î± Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î±Î³Î¿ÏÏÎ½ - ÎœÎ‘Î¥Î¡ÎŸ Î¦ÎŸÎÎ¤ÎŸ */
    .purchase-header-row {
        background: linear-gradient(135deg, #000000, #333333) !important;
        color: white !important;
        font-weight: bold !important;
    }

    .purchase-header-row th {
        color: white !important;
        font-weight: bold !important;
        background: linear-gradient(135deg, #000000, #333333) !important;
    }

    /* Î£Ï„Ï…Î» Î³Î¹Î± Ï„Î¹Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Ï€Ï‰Î»Î®ÏƒÎµÏ‰Î½ - ÎšÎŸÎšÎšÎ™ÎÎŸ Î¦ÎŸÎÎ¤ÎŸ */
    .sale-header-row {
        background: linear-gradient(135deg, #8B0000, #B22222) !important;
        color: white !important;
        font-weight: bold !important;
    }

    .sale-header-row th {
        color: white !important;
        font-weight: bold !important;
        background: linear-gradient(135deg, #8B0000, #B22222) !important;
    }

    /* Bold ÏƒÏÎ½Î¿Î»Î± Î±Î³Î¿ÏÏÎ½ */
    .purchase-totals-row {
        background: linear-gradient(135deg, #000000, #333333) !important;
        color: white !important;
        font-weight: bold !important;
    }

    .purchase-totals-row td {
        color: white !important;
        font-weight: bold !important;
    }

    /* Bold ÏƒÏÎ½Î¿Î»Î± Ï€Ï‰Î»Î®ÏƒÎµÏ‰Î½ */
    .sale-totals-row {
        background: linear-gradient(135deg, #8B0000, #B22222) !important;
        color: white !important;
        font-weight: bold !important;
    }

    .sale-totals-row td {
        color: white !important;
        font-weight: bold !important;
    }
    
    /* ÎœÎµÎ³Î±Î»ÏÏ„ÎµÏÎ· Î³ÏÎ±Î¼Î¼Î±Ï„Î¿ÏƒÎµÎ¹ÏÎ¬ Î³Î¹Î± ÎºÎ­ÏÎ´Î·/Î¶Î·Î¼Î¯ÎµÏ‚ */
    .bold-pl {
        font-size: 18px !important;
        font-weight: 900 !important;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.3) !important;
    }
    
    /* Î§Ï‰ÏÎ¹ÏƒÏ„Î­Ï‚ Î³ÏÎ±Î¼Î¼Î­Ï‚ Î³Î¹Î± ÎºÎ¬Î¸Îµ ÎºÎ¬Ï„Î¿Ï‡Î¿ ÏƒÏ„Î¿ summary */
    .separate-owner-row {
        border-bottom: 2px solid #ddd;
    }
    
    .separate-owner-row td {
        padding: 10px !important;
    }
  </style>
</head>
<body>

<h1>ğŸ“ˆ Î ÎŸÎ¡Î¤ÎŸÎ¦ÎŸÎ›Î™Î‘ ÎœÎ•Î¤ÎŸÎ§Î©Î</h1>

<div class="portfolio-selector">
  <button onclick="switchPortfolio('mitsos')" id="btn-mitsos" class="active">ğŸ‘¤ ÎšÎ¬Ï„Î¿Ï‡Î¿Ï‚: ÎœÎ—Î¤Î£ÎŸÎ£</button>
  <button onclick="switchPortfolio('aderfoula')" id="btn-aderfoula">ğŸ‘¤ ÎšÎ¬Ï„Î¿Ï‡Î¿Ï‚: Î‘Î”Î•Î¡Î¦ÎŸÎ¥Î›Î‘</button>
  <button onclick="switchPortfolio('father')" id="btn-father">ğŸ‘¤ ÎšÎ¬Ï„Î¿Ï‡Î¿Ï‚: FATHER</button>
  <button onclick="switchPortfolio('summary')" id="btn-summary">ğŸ“Š Î£ÏÎ½Î¿ÏˆÎ· ÎŒÎ»Ï‰Î½</button>
</div>

<div id="mitsos-portfolio" class="portfolio-content">
  <div class="section-title">Î Î¿ÏÏ„Î¿Ï†ÏŒÎ»Î¹Î¿ - <span class="owner-name">ÎšÎ¬Ï„Î¿Ï‡Î¿Ï‚: ÎœÎ—Î¤Î£ÎŸÎ£</span></div>
  
  <div class="controls">
    <button onclick="addPurchaseRow('mitsos')" class="add-purchase">â• Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î‘Î³Î¿ÏÎ¬Ï‚</button>
    <button onclick="addSaleRow('mitsos')" class="add-sale">â– Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î ÏÎ»Î·ÏƒÎ·Ï‚</button>
    <button onclick="savePortfolio('mitsos')" class="save">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
    <button onclick="saveAllData()" class="save-all">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÎŒÎ»Ï‰Î½</button>
  </div>

  <div class="sub-section-title">Î‘Î“ÎŸÎ¡Î•Î£</div>
  <table id="mitsos-purchases">
    <thead>
      <tr class="purchase-header-row">
        <th>Î‘/Î‘</th>
        <th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î‘Î³Î¿ÏÎ¬Ï‚</th>
        <th>ÎŒÎ½Î¿Î¼Î± ÎœÎµÏ„Î¿Ï‡Î®Ï‚</th>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î¤Î¹Î¼Î® Î‘Î³Î¿ÏÎ¬Ï‚/Ï„ÎµÎ¼. (â‚¬)</th>
        <th>Î‘Î¾Î¯Î± Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹ÎµÏ‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ (â‚¬)</th>
        <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î¤Î¹Î¼Î® (â‚¬)</th>
        <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î± (â‚¬)</th>
        <th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î‘Ï€Î¿ÎºÎ¿Ï€Î®Ï‚ ÎœÎµÏÎ¯ÏƒÎ¼Î±Ï„Î¿Ï‚</th>
        <th>ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î”Î¹Î±Î³ÏÎ±Ï†Î®</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr class="purchase-totals-row">
        <td colspan="3"><strong>Î£Î¥ÎÎŸÎ›ÎŸ Î‘Î“ÎŸÎ¡Î©Î:</strong></td>
        <td id="mitsos-total-purchase-qty">0</td>
        <td id="mitsos-avg-purchase-price">0.00</td>
        <td id="mitsos-total-purchase-value">0.00</td>
        <td id="mitsos-total-purchase-commissions">0.00</td>
        <td id="mitsos-total-purchase-cost">0.00</td>
        <td>-</td>
        <td id="mitsos-total-current-value">0.00</td>
        <td>-</td>
        <td id="mitsos-total-dividends">0.00</td>
        <td></td>
      </tr>
    </tfoot>
  </table>

  <div class="sub-section-title">Î Î©Î›Î—Î£Î•Î™Î£</div>
  <table id="mitsos-sales">
    <thead>
      <tr class="sale-header-row">
        <th>Î‘/Î‘</th>
        <th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î ÏÎ»Î·ÏƒÎ·Ï‚</th>
        <th>ÎŒÎ½Î¿Î¼Î± ÎœÎµÏ„Î¿Ï‡Î®Ï‚</th>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î¤Î¹Î¼Î® Î ÏÎ»Î·ÏƒÎ·Ï‚/Ï„ÎµÎ¼. (â‚¬)</th>
        <th>Î‘Î¾Î¯Î± Î ÏÎ»Î·ÏƒÎ·Ï‚ (â‚¬)</th>
        <th>Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹ÎµÏ‚ Î ÏÎ»Î·ÏƒÎ·Ï‚ (â‚¬)</th>
        <th>ÎšÎ±Î¸Î±ÏÎ­Ï‚ Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÎ¹Ï‚ (â‚¬)</th>
        <th>ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î”Î¹Î±Î³ÏÎ±Ï†Î®</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr class="sale-totals-row">
        <td colspan="3"><strong>Î£Î¥ÎÎŸÎ›ÎŸ Î Î©Î›Î—Î£Î•Î©Î:</strong></td>
        <td id="mitsos-total-sale-qty">0</td>
        <td id="mitsos-avg-sale-price">0.00</td>
        <td id="mitsos-total-sale-value">0.00</td>
        <td id="mitsos-total-sale-commissions">0.00</td>
        <td id="mitsos-total-net-proceeds">0.00</td>
        <td id="mitsos-total-sale-pl">0.00</td>
        <td></td>
      </tr>
    </tfoot>
  </table>

  <div class="section-title">Î£ÏÎ½Î¿Î»Î± Î Î¿ÏÏ„Î¿Ï†Î¿Î»Î¯Î¿Ï…</div>
  <table id="mitsos-calculations">
    <thead>
      <tr>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î± Ï€Î¿Ï… ÎšÏÎ±Ï„Î¿ÏÎ½Ï„Î±Î¹</th>
        <th>ÎœÎ­ÏƒÎ· Î¤Î¹Î¼Î® Î‘Î³Î¿ÏÎ¬Ï‚/Ï„ÎµÎ¼. (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î± ÎœÎµÏ„Î¿Ï‡ÏÎ½ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ ÎšÎ­ÏÎ´Î¿Ï…Ï‚/Î–Î·Î¼Î¯Î±Ï‚ (%)</th>
      </tr>
    </thead>
    <tbody>
      <tr class="calculations-row">
        <td id="mitsos-held-shares">0</td>
        <td id="mitsos-avg-cost-price">0.00</td>
        <td id="mitsos-total-cost">0.00</td>
        <td id="mitsos-current-value">0.00</td>
        <td id="mitsos-total-dividends-sum">0.00</td>
        <td id="mitsos-total-PL" class="bold-pl">0.00</td>
        <td id="mitsos-total-PLPercent" class="bold-pl">0.00%</td>
      </tr>
    </tbody>
  </table>
  
  <div class="section-title">Î Î»Î®ÏÎµÏ‚ Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Î‘Î½Î¬ ÎœÎµÏ„Î¿Ï‡Î®</div>
  <table id="mitsos-stock-history" class="history-table">
    <thead>
      <tr>
        <th>ÎœÎµÏ„Î¿Ï‡Î®</th>
        <th>ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î‘Î³Î¿ÏÎ±ÏƒÎ¼Î­Î½Î± Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î Ï‰Î»Î·Î¼Î­Î½Î± Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î± Ï€Î¿Ï… ÎšÏÎ±Ï„Î¿ÏÎ½Ï„Î±Î¹</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ­Ï‚ ÎšÎ±Î¸Î±ÏÎ­Ï‚ Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÎ¹Ï‚ Î Ï‰Î»Î®ÏƒÎµÏ‰Î½ (â‚¬)</th>
        <th>Î¤ÎµÎ»Î¹ÎºÏŒ ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î¤ÎµÎ»Î¹ÎºÏŒ Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ ÎšÎ­ÏÎ´Î¿Ï…Ï‚/Î–Î·Î¼Î¯Î±Ï‚ (%)</th>
      </tr>
    </thead>
    <tbody id="mitsos-stock-history-body">
    </tbody>
  </table>
  
  <div class="section-title">Î Î»Î®ÏÎµÏ‚ Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Î‘Î½Î¬ ÎœÎµÏ„Î¿Ï‡Î® (Î Î©Î›Î—Î˜Î•Î™Î£Î•Î£ ÎŸÎ›ÎŸÎšÎ›Î—Î¡Î©Î¤Î™ÎšÎ‘)</div>
  <table id="mitsos-sold-stock-history" class="history-table">
    <thead>
      <tr>
        <th>ÎœÎµÏ„Î¿Ï‡Î®</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î‘Î³Î¿ÏÎ±ÏƒÎ¼Î­Î½Î± Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î Ï‰Î»Î·Î¼Î­Î½Î± Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ­Ï‚ ÎšÎ±Î¸Î±ÏÎ­Ï‚ Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÎ¹Ï‚ Î Ï‰Î»Î®ÏƒÎµÏ‰Î½ (â‚¬)</th>
        <th>Î¤ÎµÎ»Î¹ÎºÏŒ ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î¤ÎµÎ»Î¹ÎºÏŒ Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ ÎšÎ­ÏÎ´Î¿Ï…Ï‚/Î–Î·Î¼Î¯Î±Ï‚ (%)</th>
      </tr>
    </thead>
    <tbody id="mitsos-sold-stock-history-body">
    </tbody>
  </table>
</div>

<div id="aderfoula-portfolio" class="portfolio-content hidden">
  <div class="section-title">Î Î¿ÏÏ„Î¿Ï†ÏŒÎ»Î¹Î¿ - <span class="owner-name">ÎšÎ¬Ï„Î¿Ï‡Î¿Ï‚: Î‘Î”Î•Î¡Î¦ÎŸÎ¥Î›Î‘</span></div>
  
  <div class="controls">
    <button onclick="addPurchaseRow('aderfoula')" class="add-purchase">â• Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î‘Î³Î¿ÏÎ¬Ï‚</button>
    <button onclick="addSaleRow('aderfoula')" class="add-sale">â– Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î ÏÎ»Î·ÏƒÎ·Ï‚</button>
    <button onclick="savePortfolio('aderfoula')" class="save">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
    <button onclick="saveAllData()" class="save-all">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÎŒÎ»Ï‰Î½</button>
  </div>

  <div class="sub-section-title">Î‘Î“ÎŸÎ¡Î•Î£</div>
  <table id="aderfoula-purchases">
    <thead>
      <tr class="purchase-header-row">
        <th>Î‘/Î‘</th>
        <th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î‘Î³Î¿ÏÎ¬Ï‚</th>
        <th>ÎŒÎ½Î¿Î¼Î± ÎœÎµÏ„Î¿Ï‡Î®Ï‚</th>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î¤Î¹Î¼Î® Î‘Î³Î¿ÏÎ¬Ï‚/Ï„ÎµÎ¼. (â‚¬)</th>
        <th>Î‘Î¾Î¯Î± Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹ÎµÏ‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ (â‚¬)</th>
        <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î¤Î¹Î¼Î® (â‚¬)</th>
        <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î± (â‚¬)</th>
        <th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î‘Ï€Î¿ÎºÎ¿Ï€Î®Ï‚ ÎœÎµÏÎ¯ÏƒÎ¼Î±Ï„Î¿Ï‚</th>
        <th>ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î”Î¹Î±Î³ÏÎ±Ï†Î®</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr class="purchase-totals-row">
        <td colspan="3"><strong>Î£Î¥ÎÎŸÎ›ÎŸ Î‘Î“ÎŸÎ¡Î©Î:</strong></td>
        <td id="aderfoula-total-purchase-qty">0</td>
        <td id="aderfoula-avg-purchase-price">0.00</td>
        <td id="aderfoula-total-purchase-value">0.00</td>
        <td id="aderfoula-total-purchase-commissions">0.00</td>
        <td id="aderfoula-total-purchase-cost">0.00</td>
        <td>-</td>
        <td id="aderfoula-total-current-value">0.00</td>
        <td>-</td>
        <td id="aderfoula-total-dividends">0.00</td>
        <td></td>
      </tr>
    </tfoot>
  </table>

  <div class="sub-section-title">Î Î©Î›Î—Î£Î•Î™Î£</div>
  <table id="aderfoula-sales">
    <thead>
      <tr class="sale-header-row">
        <th>Î‘/Î‘</th>
        <th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î ÏÎ»Î·ÏƒÎ·Ï‚</th>
        <th>ÎŒÎ½Î¿Î¼Î± ÎœÎµÏ„Î¿Ï‡Î®Ï‚</th>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î¤Î¹Î¼Î® Î ÏÎ»Î·ÏƒÎ·Ï‚/Ï„ÎµÎ¼. (â‚¬)</th>
        <th>Î‘Î¾Î¯Î± Î ÏÎ»Î·ÏƒÎ·Ï‚ (â‚¬)</th>
        <th>Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹ÎµÏ‚ Î ÏÎ»Î·ÏƒÎ·Ï‚ (â‚¬)</th>
        <th>ÎšÎ±Î¸Î±ÏÎ­Ï‚ Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÎ¹Ï‚ (â‚¬)</th>
        <th>ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î”Î¹Î±Î³ÏÎ±Ï†Î®</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr class="sale-totals-row">
        <td colspan="3"><strong>Î£Î¥ÎÎŸÎ›ÎŸ Î Î©Î›Î—Î£Î•Î©Î:</strong></td>
        <td id="aderfoula-total-sale-qty">0</td>
        <td id="aderfoula-avg-sale-price">0.00</td>
        <td id="aderfoula-total-sale-value">0.00</td>
        <td id="aderfoula-total-sale-commissions">0.00</td>
        <td id="aderfoula-total-net-proceeds">0.00</td>
        <td id="aderfoula-total-sale-pl">0.00</td>
        <td></td>
      </tr>
    </tfoot>
  </table>

  <div class="section-title">Î£ÏÎ½Î¿Î»Î± Î Î¿ÏÏ„Î¿Ï†Î¿Î»Î¯Î¿Ï…</div>
  <table id="aderfoula-calculations">
    <thead>
      <tr>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î± Ï€Î¿Ï… ÎšÏÎ±Ï„Î¿ÏÎ½Ï„Î±Î¹</th>
        <th>ÎœÎ­ÏƒÎ· Î¤Î¹Î¼Î® Î‘Î³Î¿ÏÎ¬Ï‚/Ï„ÎµÎ¼. (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î± ÎœÎµÏ„Î¿Ï‡ÏÎ½ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ ÎšÎ­ÏÎ´Î¿Ï…Ï‚/Î–Î·Î¼Î¯Î±Ï‚ (%)</th>
      </tr>
    </thead>
    <tbody>
      <tr class="calculations-row">
        <td id="aderfoula-held-shares">0</td>
        <td id="aderfoula-avg-cost-price">0.00</td>
        <td id="aderfoula-total-cost">0.00</td>
        <td id="aderfoula-current-value">0.00</td>
        <td id="aderfoula-total-dividends-sum">0.00</td>
        <td id="aderfoula-total-PL" class="bold-pl">0.00</td>
        <td id="aderfoula-total-PLPercent" class="bold-pl">0.00%</td>
      </tr>
    </tbody>
  </table>
  
  <div class="section-title">Î Î»Î®ÏÎµÏ‚ Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Î‘Î½Î¬ ÎœÎµÏ„Î¿Ï‡Î®</div>
  <table id="aderfoula-stock-history" class="history-table">
    <thead>
      <tr>
        <th>ÎœÎµÏ„Î¿Ï‡Î®</th>
        <th>ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î‘Î³Î¿ÏÎ±ÏƒÎ¼Î­Î½Î± Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î Ï‰Î»Î·Î¼Î­Î½Î± Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î± Ï€Î¿Ï… ÎšÏÎ±Ï„Î¿ÏÎ½Ï„Î±Î¹</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ­Ï‚ ÎšÎ±Î¸Î±ÏÎ­Ï‚ Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÎ¹Ï‚ Î Ï‰Î»Î®ÏƒÎµÏ‰Î½ (â‚¬)</th>
        <th>Î¤ÎµÎ»Î¹ÎºÏŒ ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î¤ÎµÎ»Î¹ÎºÏŒ Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ ÎšÎ­ÏÎ´Î¿Ï…Ï‚/Î–Î·Î¼Î¯Î±Ï‚ (%)</th>
      </tr>
    </thead>
    <tbody id="aderfoula-stock-history-body">
    </tbody>
  </table>
  
  <div class="section-title">Î Î»Î®ÏÎµÏ‚ Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Î‘Î½Î¬ ÎœÎµÏ„Î¿Ï‡Î® (Î Î©Î›Î—Î˜Î•Î™Î£Î•Î£ ÎŸÎ›ÎŸÎšÎ›Î—Î¡Î©Î¤Î™ÎšÎ‘)</div>
  <table id="aderfoula-sold-stock-history" class="history-table">
    <thead>
      <tr>
        <th>ÎœÎµÏ„Î¿Ï‡Î®</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î‘Î³Î¿ÏÎ±ÏƒÎ¼Î­Î½Î± Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î Ï‰Î»Î·Î¼Î­Î½Î± Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ­Ï‚ ÎšÎ±Î¸Î±ÏÎ­Ï‚ Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÎ¹Ï‚ Î Ï‰Î»Î®ÏƒÎµÏ‰Î½ (â‚¬)</th>
        <th>Î¤ÎµÎ»Î¹ÎºÏŒ ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î¤ÎµÎ»Î¹ÎºÏŒ Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ ÎšÎ­ÏÎ´Î¿Ï…Ï‚/Î–Î·Î¼Î¯Î±Ï‚ (%)</th>
      </tr>
    </thead>
    <tbody id="aderfoula-sold-stock-history-body">
    </tbody>
  </table>
</div>

<div id="father-portfolio" class="portfolio-content hidden">
  <div class="section-title">Î Î¿ÏÏ„Î¿Ï†ÏŒÎ»Î¹Î¿ - <span class="owner-name">ÎšÎ¬Ï„Î¿Ï‡Î¿Ï‚: FATHER</span></div>
  
  <div class="controls">
    <button onclick="addPurchaseRow('father')" class="add-purchase">â• Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î‘Î³Î¿ÏÎ¬Ï‚</button>
    <button onclick="addSaleRow('father')" class="add-sale">â– Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î ÏÎ»Î·ÏƒÎ·Ï‚</button>
    <button onclick="savePortfolio('father')" class="save">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
    <button onclick="saveAllData()" class="save-all">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÎŒÎ»Ï‰Î½</button>
  </div>

  <div class="sub-section-title">Î‘Î“ÎŸÎ¡Î•Î£</div>
  <table id="father-purchases">
    <thead>
      <tr class="purchase-header-row">
        <th>Î‘/Î‘</th>
        <th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î‘Î³Î¿ÏÎ¬Ï‚</th>
        <th>ÎŒÎ½Î¿Î¼Î± ÎœÎµÏ„Î¿Ï‡Î®Ï‚</th>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î¤Î¹Î¼Î® Î‘Î³Î¿ÏÎ¬Ï‚/Ï„ÎµÎ¼. (â‚¬)</th>
        <th>Î‘Î¾Î¯Î± Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹ÎµÏ‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ (â‚¬)</th>
        <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î¤Î¹Î¼Î® (â‚¬)</th>
        <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î± (â‚¬)</th>
        <th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î‘Ï€Î¿ÎºÎ¿Ï€Î®Ï‚ ÎœÎµÏÎ¯ÏƒÎ¼Î±Ï„Î¿Ï‚</th>
        <th>ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î”Î¹Î±Î³ÏÎ±Ï†Î®</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr class="purchase-totals-row">
        <td colspan="3"><strong>Î£Î¥ÎÎŸÎ›ÎŸ Î‘Î“ÎŸÎ¡Î©Î:</strong></td>
        <td id="father-total-purchase-qty">0</td>
        <td id="father-avg-purchase-price">0.00</td>
        <td id="father-total-purchase-value">0.00</td>
        <td id="father-total-purchase-commissions">0.00</td>
        <td id="father-total-purchase-cost">0.00</td>
        <td>-</td>
        <td id="father-total-current-value">0.00</td>
        <td>-</td>
        <td id="father-total-dividends">0.00</td>
        <td></td>
      </tr>
    </tfoot>
  </table>

  <div class="sub-section-title">Î Î©Î›Î—Î£Î•Î™Î£</div>
  <table id="father-sales">
    <thead>
      <tr class="sale-header-row">
        <th>Î‘/Î‘</th>
        <th>Î—Î¼ÎµÏÎ¿Î¼Î·Î½Î¯Î± Î ÏÎ»Î·ÏƒÎ·Ï‚</th>
        <th>ÎŒÎ½Î¿Î¼Î± ÎœÎµÏ„Î¿Ï‡Î®Ï‚</th>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î¤Î¹Î¼Î® Î ÏÎ»Î·ÏƒÎ·Ï‚/Ï„ÎµÎ¼. (â‚¬)</th>
        <th>Î‘Î¾Î¯Î± Î ÏÎ»Î·ÏƒÎ·Ï‚ (â‚¬)</th>
        <th>Î ÏÎ¿Î¼Î®Î¸ÎµÎ¹ÎµÏ‚ Î ÏÎ»Î·ÏƒÎ·Ï‚ (â‚¬)</th>
        <th>ÎšÎ±Î¸Î±ÏÎ­Ï‚ Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÎ¹Ï‚ (â‚¬)</th>
        <th>ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î”Î¹Î±Î³ÏÎ±Ï†Î®</th>
      </tr>
    </thead>
    <tbody></tbody>
    <tfoot>
      <tr class="sale-totals-row">
        <td colspan="3"><strong>Î£Î¥ÎÎŸÎ›ÎŸ Î Î©Î›Î—Î£Î•Î©Î:</strong></td>
        <td id="father-total-sale-qty">0</td>
        <td id="father-avg-sale-price">0.00</td>
        <td id="father-total-sale-value">0.00</td>
        <td id="father-total-sale-commissions">0.00</td>
        <td id="father-total-net-proceeds">0.00</td>
        <td id="father-total-sale-pl">0.00</td>
        <td></td>
      </tr>
    </tfoot>
  </table>

  <div class="section-title">Î£ÏÎ½Î¿Î»Î± Î Î¿ÏÏ„Î¿Ï†Î¿Î»Î¯Î¿Ï…</div>
  <table id="father-calculations">
    <thead>
      <tr>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î± Ï€Î¿Ï… ÎšÏÎ±Ï„Î¿ÏÎ½Ï„Î±Î¹</th>
        <th>ÎœÎ­ÏƒÎ· Î¤Î¹Î¼Î® Î‘Î³Î¿ÏÎ¬Ï‚/Ï„ÎµÎ¼. (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î± ÎœÎµÏ„Î¿Ï‡ÏÎ½ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ ÎšÎ­ÏÎ´Î¿Ï…Ï‚/Î–Î·Î¼Î¯Î±Ï‚ (%)</th>
      </tr>
    </thead>
    <tbody>
      <tr class="calculations-row">
        <td id="father-held-shares">0</td>
        <td id="father-avg-cost-price">0.00</td>
        <td id="father-total-cost">0.00</td>
        <td id="father-current-value">0.00</td>
        <td id="father-total-dividends-sum">0.00</td>
        <td id="father-total-PL" class="bold-pl">0.00</td>
        <td id="father-total-PLPercent" class="bold-pl">0.00%</td>
      </tr>
    </tbody>
  </table>
  
  <div class="section-title">Î Î»Î®ÏÎµÏ‚ Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Î‘Î½Î¬ ÎœÎµÏ„Î¿Ï‡Î®</div>
  <table id="father-stock-history" class="history-table">
    <thead>
      <tr>
        <th>ÎœÎµÏ„Î¿Ï‡Î®</th>
        <th>ÎšÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î‘Î³Î¿ÏÎ±ÏƒÎ¼Î­Î½Î± Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î Ï‰Î»Î·Î¼Î­Î½Î± Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î± Ï€Î¿Ï… ÎšÏÎ±Ï„Î¿ÏÎ½Ï„Î±Î¹</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ­Ï‚ ÎšÎ±Î¸Î±ÏÎ­Ï‚ Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÎ¹Ï‚ Î Ï‰Î»Î®ÏƒÎµÏ‰Î½ (â‚¬)</th>
        <th>Î¤ÎµÎ»Î¹ÎºÏŒ ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î¤ÎµÎ»Î¹ÎºÏŒ Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ ÎšÎ­ÏÎ´Î¿Ï…Ï‚/Î–Î·Î¼Î¯Î±Ï‚ (%)</th>
      </tr>
    </thead>
    <tbody id="father-stock-history-body">
    </tbody>
  </table>
  
  <div class="section-title">Î Î»Î®ÏÎµÏ‚ Î™ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Î‘Î½Î¬ ÎœÎµÏ„Î¿Ï‡Î® (Î Î©Î›Î—Î˜Î•Î™Î£Î•Î£ ÎŸÎ›ÎŸÎšÎ›Î—Î¡Î©Î¤Î™ÎšÎ‘)</div>
  <table id="father-sold-stock-history" class="history-table">
    <thead>
      <tr>
        <th>ÎœÎµÏ„Î¿Ï‡Î®</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î‘Î³Î¿ÏÎ±ÏƒÎ¼Î­Î½Î± Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î Ï‰Î»Î·Î¼Î­Î½Î± Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ­Ï‚ ÎšÎ±Î¸Î±ÏÎ­Ï‚ Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÎ¹Ï‚ Î Ï‰Î»Î®ÏƒÎµÏ‰Î½ (â‚¬)</th>
        <th>Î¤ÎµÎ»Î¹ÎºÏŒ ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î¤ÎµÎ»Î¹ÎºÏŒ Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ ÎšÎ­ÏÎ´Î¿Ï…Ï‚/Î–Î·Î¼Î¯Î±Ï‚ (%)</th>
      </tr>
    </thead>
    <tbody id="father-sold-stock-history-body">
    </tbody>
  </table>
</div>

<div id="summary-portfolio" class="portfolio-content hidden">
  <div class="section-title">ğŸ“Š Î£Î¥ÎÎŸÎ¨Î— ÎŸÎ›Î©Î Î¤Î©Î Î ÎŸÎ¡Î¤ÎŸÎ¦ÎŸÎ›Î™Î©Î</div>
  
  <div class="sub-section-title">Î£ÏÎ½Î¿Î»Î± Î‘Î½Î±Î»Ï…Ï„Î¹ÎºÎ¬</div>
  <table id="summary-table">
    <thead>
      <tr>
        <th>ÎšÎ¬Ï„Î¿Ï‡Î¿Ï‚</th>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î± Ï€Î¿Ï… ÎšÏÎ±Ï„Î¿ÏÎ½Ï„Î±Î¹</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ­Ï‚ ÎšÎ±Î¸Î±ÏÎ­Ï‚ Î•Î¹ÏƒÏ€ÏÎ¬Î¾ÎµÎ¹Ï‚ (â‚¬)</th>
        <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î± ÎœÎµÏ„Î¿Ï‡ÏÎ½ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¯Î± (â‚¬)</th>
        <th>Î Î¿ÏƒÎ¿ÏƒÏ„ÏŒ ÎšÎ­ÏÎ´Î¿Ï…Ï‚/Î–Î·Î¼Î¯Î±Ï‚ (%)</th>
      </tr>
    </thead>
    <tbody>
      <tr class="separate-owner-row">
        <td><span class="owner-mitsos">ÎœÎ—Î¤Î£ÎŸÎ£</span></td>
        <td id="summary-mitsos-held">0</td>
        <td id="summary-mitsos-cost">0.00</td>
        <td id="summary-mitsos-proceeds">0.00</td>
        <td id="summary-mitsos-current">0.00</td>
        <td id="summary-mitsos-dividends">0.00</td>
        <td id="summary-mitsos-pl" class="bold-pl">0.00</td>
        <td id="summary-mitsos-plpercent" class="bold-pl">0.00%</td>
      </tr>
      <tr class="separate-owner-row">
        <td><span class="owner-aderfoula">Î‘Î”Î•Î¡Î¦ÎŸÎ¥Î›Î‘</span></td>
        <td id="summary-aderfoula-held">0</td>
        <td id="summary-aderfoula-cost">0.00</td>
        <td id="summary-aderfoula-proceeds">0.00</td>
        <td id="summary-aderfoula-current">0.00</td>
        <td id="summary-aderfoula-dividends">0.00</td>
        <td id="summary-aderfoula-pl" class="bold-pl">0.00</td>
        <td id="summary-aderfoula-plpercent" class="bold-pl">0.00%</td>
      </tr>
      <tr class="separate-owner-row">
        <td><span class="owner-father">FATHER</span></td>
        <td id="summary-father-held">0</td>
        <td id="summary-father-cost">0.00</td>
        <td id="summary-father-proceeds">0.00</td>
        <td id="summary-father-current">0.00</td>
        <td id="summary-father-dividends">0.00</td>
        <td id="summary-father-pl" class="bold-pl">0.00</td>
        <td id="summary-father-plpercent" class="bold-pl">0.00%</td>
      </tr>
      <tr class="calculations-row">
        <td><strong>Î£Î¥ÎÎŸÎ›ÎŸ</strong></td>
        <td id="summary-total-held">0</td>
        <td id="summary-total-cost">0.00</td>
        <td id="summary-total-proceeds">0.00</td>
        <td id="summary-total-current">0.00</td>
        <td id="summary-total-dividends">0.00</td>
        <td id="summary-total-pl" class="bold-pl">0.00</td>
        <td id="summary-total-plpercent" class="bold-pl">0.00%</td>
      </tr>
    </tbody>
  </table>
  
  <div class="sub-section-title">Î£ÏÎ½Î¿Î»Î¿ ÎœÎµÏ„Î¿Ï‡ÏÎ½ Î‘Î½Î¬ ÎšÎ¬Ï„Î¿Ï‡Î¿</div>
  <table id="summary-stocks-by-owner">
    <thead>
      <tr>
        <th>ÎšÎ¬Ï„Î¿Ï‡Î¿Ï‚</th>
        <th>Î Î»Î®Î¸Î¿Ï‚ ÎœÎµÏ„Î¿Ï‡ÏÎ½ (ÎœÎ¿Î½Î±Î´Î¹ÎºÎ­Ï‚)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ¬ Î¤ÎµÎ¼Î¬Ï‡Î¹Î± Ï€Î¿Ï… ÎšÏÎ±Ï„Î¿ÏÎ½Ï„Î±Î¹</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÎ® Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î± (â‚¬)</th>
      </tr>
    </thead>
    <tbody id="summary-stocks-by-owner-body">
    </tbody>
  </table>
  
  <div class="sub-section-title">Î£ÏÎ½Î¿Î»Î¿ ÎœÎµÏ„Î¿Ï‡ÏÎ½ Î‘Î½Î¬ ÎŒÎ½Î¿Î¼Î± ÎœÎµÏ„Î¿Ï‡Î®Ï‚</div>
  <table id="summary-stocks-by-name">
    <thead>
      <tr>
        <th>ÎœÎµÏ„Î¿Ï‡Î®</th>
        <th>ÎšÎ¬Ï„Î¿Ï‡Î¿Ï‚</th>
        <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î± Ï€Î¿Ï… ÎšÏÎ±Ï„Î¿ÏÎ½Ï„Î±Î¹</th>
        <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
        <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î± (â‚¬)</th>
        <th>ÎœÎ­ÏÎ¹ÏƒÎ¼Î± (â‚¬)</th>
      </tr>
    </thead>
    <tbody id="summary-stocks-by-name-body">
    </tbody>
  </table>
</div>

<div id="chart-container">
  <canvas id="chart" height="100"></canvas>
</div>

<script>
let chart;
let currentPortfolio = 'mitsos';
const portfolios = ['mitsos', 'aderfoula', 'father'];

// Î£Ï…Î½Î¬ÏÏ„Î·ÏƒÎ· ÎµÎ¼Ï†Î¬Î½Î¹ÏƒÎ·Ï‚ Î¼Î·Î½ÏÎ¼Î±Ï„Î¿Ï‚
function showMessage(message, type = 'success') {
  const messageDiv = document.createElement('div');
  messageDiv.className = 'message';
  messageDiv.textContent = message;
  document.body.appendChild(messageDiv);
  
  setTimeout(() => {
    messageDiv.remove();
  }, 3000);
}

// Î£Ï…Î½Î¬ÏÏ„Î·ÏƒÎ· Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼Î¿Ï Î±Î¸ÏÎ¿Î¯ÏƒÎ¼Î±Ï„Î¿Ï‚ Î±Ï€ÏŒ Î­ÎºÏ†ÏÎ±ÏƒÎ·
function calculateExpression(expression) {
  try {
    // Î‘Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· ÎµÎ»Î»Î·Î½Î¹ÎºÏÎ½ ÎºÏŒÎ¼Î¼Î± Î¼Îµ Ï„ÎµÎ»ÎµÎ¯ÎµÏ‚
    expression = expression.replace(/,/g, '.');
    // Î‘Î½Ï„Î¹ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ· Ï€Î¿Î»Î»Î±Ï€Î»ÏÎ½ ÏƒÏ…Î½ ÏƒÏ„Î¿ Ï„Î­Î»Î¿Ï‚
    expression = expression.replace(/\+\s*$/g, '');
    
    if (!expression.trim()) return 0;
    
    // Î”Î¹Î±Ï‡Ï‰ÏÎ¹ÏƒÎ¼ÏŒÏ‚ Î¼Îµ +
    const parts = expression.split('+').map(part => part.trim());
    let total = 0;
    
    for (let part of parts) {
      if (part) {
        const num = parseFloat(part);
        if (!isNaN(num)) {
          total += num;
        }
      }
    }
    
    return total;
  } catch (e) {
    return 0;
  }
}

// Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î³ÏÎ±Î¼Î¼Î®Ï‚ Î±Î³Î¿ÏÎ¬Ï‚
function addPurchaseRow(portfolio, data = {}) {
  const tbody = document.querySelector(`#${portfolio}-purchases tbody`);
  const row = document.createElement('tr');
  const rowIndex = tbody.children.length + 1;
  const currentDate = new Date().toISOString().split('T')[0];

  row.innerHTML = `
    <td>${rowIndex}</td>
    <td><input type="date" value="${data.date || currentDate}" /></td>
    <td><input value="${data.name || ''}" placeholder="Ï€.Ï‡. Apple Inc." class="stock-name" /></td>
    <td><input type="number" min="0" step="1" value="${data.qty || 0}" class="purchase-qty" /></td>
    <td><input type="number" min="0" step="0.01" value="${data.buyPrice || 0.00}" class="purchase-price" /></td>
    <td class="purchaseValue">0.00</td>
    <td><input type="text" value="${data.commission || ''}" class="purchase-commission commission-input" placeholder="15+7+2,47+6,28" /></td>
    <td class="totalCost">0.00</td>
    <td><input type="number" min="0" step="0.01" value="${data.currentPrice || 0.00}" class="current-price current-price-input" placeholder="Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Ï„Î¹Î¼Î®" /></td>
    <td class="currentValue">0.00</td>
    <td><input type="date" value="${data.dividendDate || ''}" class="dividend-date" /></td>
    <td><input type="number" min="0" step="0.01" value="${data.dividend || 0.00}" class="dividend dividend-input" placeholder="ÎœÎ­ÏÎ¹ÏƒÎ¼Î±" /></td>
    <td><button onclick="deleteRow(this, '${portfolio}', 'purchase')" class="delete" style="padding: 3px 8px; font-size:12px; background:#e74c3c; color:white; border:none; border-radius:4px; cursor:pointer;">âœ•</button></td>
  `;

  tbody.appendChild(row);
  
  // Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· event listeners
 row.querySelectorAll('input').forEach(input => {
  if (input.classList.contains('purchase-commission')) {
    input.addEventListener('input', () => {
      const calculatedValue = calculateExpression(input.value);
      input.title = `Î£ÏÎ½Î¿Î»Î¿: ${calculatedValue.toFixed(2)}â‚¬`;
      calculatePortfolio(portfolio);
      savePortfolioData(portfolio); // Î‘Î¥Î¤ÎŸÎœÎ‘Î¤Î— Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î—
    });
  } else {
    input.addEventListener('input', () => {
      calculatePortfolio(portfolio);
      savePortfolioData(portfolio); // Î‘Î¥Î¤ÎŸÎœÎ‘Î¤Î— Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î—
    });
  }
});
  
  calculatePortfolio(portfolio);
}

// Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î³ÏÎ±Î¼Î¼Î®Ï‚ Ï€ÏÎ»Î·ÏƒÎ·Ï‚
function addSaleRow(portfolio, data = {}) {
  const tbody = document.querySelector(`#${portfolio}-sales tbody`);
  const row = document.createElement('tr');
  const rowIndex = tbody.children.length + 1;
  const currentDate = new Date().toISOString().split('T')[0];

  row.innerHTML = `
    <td>${rowIndex}</td>
    <td><input type="date" value="${data.saleDate || currentDate}" /></td>
    <td><input value="${data.name || ''}" placeholder="Ï€.Ï‡. Apple Inc." class="sale-stock-name" /></td>
    <td><input type="number" min="0" step="1" value="${data.qty || 0}" class="sale-qty" /></td>
    <td><input type="number" min="0" step="0.01" value="${data.salePrice || 0.00}" class="sale-price" /></td>
    <td class="saleValue">0.00</td>
    <td><input type="text" value="${data.commission || ''}" class="sale-commission sale-commission-input" placeholder="15+7+2,47+6,28" /></td>
    <td class="netProceeds">0.00</td>
    <td class="pl">0.00</td>
    <td><button onclick="deleteRow(this, '${portfolio}', 'sale')" class="delete" style="padding: 3px 8px; font-size:12px; background:#e74c3c; color:white; border:none; border-radius:4px; cursor:pointer;">âœ•</button></td>
  `;

  tbody.appendChild(row);
  
  // Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· event listeners
 row.querySelectorAll('input').forEach(input => {
  if (input.classList.contains('sale-commission')) {
    input.addEventListener('input', () => {
      const calculatedValue = calculateExpression(input.value);
      input.title = `Î£ÏÎ½Î¿Î»Î¿: ${calculatedValue.toFixed(2)}â‚¬`;
      calculatePortfolio(portfolio);
      savePortfolioData(portfolio); // Î‘Î¥Î¤ÎŸÎœÎ‘Î¤Î— Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î—
    });
  } else {
    input.addEventListener('input', () => {
      calculatePortfolio(portfolio);
      savePortfolioData(portfolio); // Î‘Î¥Î¤ÎŸÎœÎ‘Î¤Î— Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î—
    });
  }
});
  
  calculatePortfolio(portfolio);
}

// Î”Î¹Î±Î³ÏÎ±Ï†Î® Î³ÏÎ±Î¼Î¼Î®Ï‚
function deleteRow(button, portfolio, type) {
  const row = button.closest('tr');
  row.remove();
  
  // Î•Ï€Î±Î½Î±ÏÎ¯Î¸Î¼Î·ÏƒÎ·
  const tbody = type === 'purchase' ? 
    document.querySelector(`#${portfolio}-purchases tbody`) : 
    document.querySelector(`#${portfolio}-sales tbody`);
  
  const rows = tbody.querySelectorAll('tr');
  rows.forEach((row, index) => {
    row.querySelector('td:first-child').textContent = index + 1;
  });
  
  calculatePortfolio(portfolio);
savePortfolioData(portfolio); // Î‘Î¥Î¤ÎŸÎœÎ‘Î¤Î— Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î—
}

// Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Ï€Î¿ÏÏ„Î¿Ï†Î¿Î»Î¯Î¿Ï… Î¼Îµ Ï€Î»Î®ÏÎµÏ‚ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ ÎºÎ±Î¹ Î±Î½Î±Î»Ï…Ï„Î¹ÎºÎ­Ï‚ Ï€Î»Î·ÏÎ¿Ï†Î¿ÏÎ¯ÎµÏ‚ Î±Î½Î¬ Î¼ÎµÏ„Î¿Ï‡Î®
function calculatePortfolio(portfolio) {
  let totalPurchaseQty = 0;
  let totalPurchaseValue = 0;
  let totalPurchaseCommissions = 0;
  let totalPurchaseCost = 0;
  let totalPurchasePriceSum = 0;
  let totalCurrentValue = 0;
  let totalDividends = 0;
  
  let totalSaleQty = 0;
  let totalSaleValue = 0;
  let totalSaleCommissions = 0;
  let totalNetProceeds = 0;
  let totalSalePriceSum = 0;
  let totalSalePL = 0;
  
  // Î‘Î½Ï„Î¹ÎºÎµÎ¯Î¼ÎµÎ½Î¿ Î³Î¹Î± Ï€Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· Ï€Î»Î®ÏÎ¿Ï…Ï‚ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÎ¿Ï Î¼ÎµÏ„Î¿Ï‡ÏÎ½
  const stockHistory = {};
  
  // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Î±Î³Î¿ÏÏÎ½
  const purchaseRows = document.querySelectorAll(`#${portfolio}-purchases tbody tr`);
  purchaseRows.forEach(row => {
    const stockName = row.querySelector('.stock-name').value.trim();
    const qty = Number(row.querySelector('.purchase-qty').value) || 0;
    const price = Number(row.querySelector('.purchase-price').value) || 0;
    const commissionExpression = row.querySelector('.purchase-commission').value || '';
    const commission = calculateExpression(commissionExpression);
    const currentPrice = Number(row.querySelector('.current-price').value) || 0;
    const dividend = Number(row.querySelector('.dividend').value) || 0;
    
    const purchaseValue = qty * price;
    const totalCost = purchaseValue + commission;
    const currentValue = qty * currentPrice;
    
    row.querySelector('.purchaseValue').innerText = purchaseValue.toFixed(2);
    row.querySelector('.totalCost').innerText = totalCost.toFixed(2);
    row.querySelector('.currentValue').innerText = currentValue.toFixed(2);
    
    totalPurchaseQty += qty;
    totalPurchaseValue += purchaseValue;
    totalPurchaseCommissions += commission;
    totalPurchaseCost += totalCost;
    totalPurchasePriceSum += price;
    totalCurrentValue += currentValue;
    totalDividends += dividend;
    
    // ÎšÎ±Ï„Î±Î³ÏÎ±Ï†Î® Î±Î³Î¿ÏÎ¬Ï‚ ÏƒÏ„Î¿ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Î¼ÎµÏ„Î¿Ï‡Î®Ï‚
    if (stockName) {
      if (!stockHistory[stockName]) {
        stockHistory[stockName] = {
          totalPurchasedQty: 0,
          totalSoldQty: 0,
          totalPurchaseCost: 0,
          totalDividends: 0,
          totalSaleProceeds: 0,
          purchases: [],
          sales: []
        };
      }
      stockHistory[stockName].totalPurchasedQty += qty;
      stockHistory[stockName].totalPurchaseCost += totalCost;
      stockHistory[stockName].totalDividends += dividend;
      stockHistory[stockName].purchases.push({
        qty: qty,
        price: price,
        commission: commission,
        totalCost: totalCost,
        dividend: dividend
      });
    }
  });
  
  // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Ï€Ï‰Î»Î®ÏƒÎµÏ‰Î½
  const saleRows = document.querySelectorAll(`#${portfolio}-sales tbody tr`);
  saleRows.forEach(row => {
    const stockName = row.querySelector('.sale-stock-name').value.trim();
    const qty = Number(row.querySelector('.sale-qty').value) || 0;
    const price = Number(row.querySelector('.sale-price').value) || 0;
    const commissionExpression = row.querySelector('.sale-commission').value || '';
    const commission = calculateExpression(commissionExpression);
    
    const saleValue = qty * price;
    const netProceeds = saleValue - commission;
    
    row.querySelector('.saleValue').innerText = saleValue.toFixed(2);
    row.querySelector('.netProceeds').innerText = netProceeds.toFixed(2);
    
    totalSaleQty += qty;
    totalSaleValue += saleValue;
    totalSaleCommissions += commission;
    totalNetProceeds += netProceeds;
    totalSalePriceSum += price;
    
    // ÎšÎ±Ï„Î±Î³ÏÎ±Ï†Î® Ï€ÏÎ»Î·ÏƒÎ·Ï‚ ÏƒÏ„Î¿ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÏŒ Î¼ÎµÏ„Î¿Ï‡Î®Ï‚
    if (stockName) {
      if (!stockHistory[stockName]) {
        stockHistory[stockName] = {
          totalPurchasedQty: 0,
          totalSoldQty: 0,
          totalPurchaseCost: 0,
          totalDividends: 0,
          totalSaleProceeds: 0,
          purchases: [],
          sales: []
        };
      }
      stockHistory[stockName].totalSoldQty += qty;
      stockHistory[stockName].totalSaleProceeds += netProceeds;
      stockHistory[stockName].sales.push({
        qty: qty,
        price: price,
        commission: commission,
        netProceeds: netProceeds
      });
    }
  });
  
  // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Ï„ÎµÎ¼Î±Ï‡Î¯Ï‰Î½ Ï€Î¿Ï… ÎºÏÎ±Ï„Î¿ÏÎ½Ï„Î±Î¹
  const heldShares = totalPurchaseQty - totalSaleQty;
  
  // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Î¼Î­ÏƒÎ·Ï‚ Ï„Î¹Î¼Î®Ï‚ Î±Î³Î¿ÏÎ¬Ï‚
  const avgPurchasePrice = totalPurchaseQty > 0 ? totalPurchaseValue / totalPurchaseQty : 0;
  const avgSalePrice = totalSaleQty > 0 ? totalSaleValue / totalSaleQty : 0;
  
  // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ÏƒÏ…Î½Î¿Î»Î¹ÎºÎ¿Ï ÎºÎ­ÏÎ´Î¿Ï…Ï‚/Î¶Î·Î¼Î¯Î±Ï‚ Î¼Îµ FIFO (First In First Out) Î¼Î­Î¸Î¿Î´Î¿
  Object.keys(stockHistory).forEach(stockName => {
    const stock = stockHistory[stockName];
    
    // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ÎºÎ­ÏÎ´Î¿Ï…Ï‚/Î¶Î·Î¼Î¯Î±Ï‚ Î¼Îµ FIFO
    let remainingShares = stock.totalPurchasedQty;
    let remainingCost = stock.totalPurchaseCost;
    let soldShares = 0;
    
    // Î¤Î±Î¾Î¹Î½ÏŒÎ¼Î·ÏƒÎ· Î±Î³Î¿ÏÏÎ½ (FIFO)
    stock.purchases.sort((a, b) => a.date - b.date);
    
    // Î“Î¹Î± ÎºÎ¬Î¸Îµ Ï€ÏÎ»Î·ÏƒÎ·
    stock.sales.forEach(sale => {
      let sharesToSell = sale.qty;
      let costOfSharesSold = 0;
      
      // Î‘Ï†Î±Î¯ÏÎµÏƒÎ· Î¼Îµ FIFO
      for (let i = 0; i < stock.purchases.length && sharesToSell > 0; i++) {
        const purchase = stock.purchases[i];
        if (purchase.qty > 0) {
          const sharesFromThisPurchase = Math.min(purchase.qty, sharesToSell);
          const costPerShare = purchase.totalCost / purchase.qty;
          costOfSharesSold += sharesFromThisPurchase * costPerShare;
          
          purchase.qty -= sharesFromThisPurchase;
          sharesToSell -= sharesFromThisPurchase;
          soldShares += sharesFromThisPurchase;
        }
      }
      
      // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ÎºÎ­ÏÎ´Î¿Ï…Ï‚/Î¶Î·Î¼Î¯Î±Ï‚ Î³Î¹Î± Î±Ï…Ï„Î® Ï„Î· Ï€ÏÎ»Î·ÏƒÎ·
      const plForSale = sale.netProceeds - costOfSharesSold;
      totalSalePL += plForSale;
    });
  });
  
  // Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎºÎ­ÏÎ´Î¿Ï‚/Î¶Î·Î¼Î¯Î± (ÏƒÏ…Î¼Ï€ÎµÏÎ¹Î»Î±Î¼Î²Î±Î½Î¿Î¼Î­Î½Ï‰Î½ Î¼ÎµÏÎ¹ÏƒÎ¼Î¬Ï„Ï‰Î½)
  const totalPL = totalCurrentValue + totalNetProceeds + totalDividends - totalPurchaseCost;
  const totalPLPercent = totalPurchaseCost > 0 ? (totalPL / totalPurchaseCost * 100) : 0;
  
  // ÎœÎ­ÏƒÎ· Ï„Î¹Î¼Î® ÎºÏŒÏƒÏ„Î¿Ï…Ï‚ Î±Î½Î¬ Ï„ÎµÎ¼Î¬Ï‡Î¹Î¿ - Î‘Î½Î± Î¼ÎµÏ„Î¿Ï‡Î® Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î¬
  const avgCostPrice = totalPurchaseQty > 0 ? totalPurchaseCost / totalPurchaseQty : 0;
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÏƒÏ…Î½Î¿Î»Î¹ÎºÏÎ½ Î±Î³Î¿ÏÏÎ½
  document.getElementById(`${portfolio}-total-purchase-qty`).innerText = totalPurchaseQty;
  document.getElementById(`${portfolio}-avg-purchase-price`).innerText = avgPurchasePrice.toFixed(2);
  document.getElementById(`${portfolio}-total-purchase-value`).innerText = totalPurchaseValue.toFixed(2);
  document.getElementById(`${portfolio}-total-purchase-commissions`).innerText = totalPurchaseCommissions.toFixed(2);
  document.getElementById(`${portfolio}-total-purchase-cost`).innerText = totalPurchaseCost.toFixed(2);
  document.getElementById(`${portfolio}-total-current-value`).innerText = totalCurrentValue.toFixed(2);
  document.getElementById(`${portfolio}-total-dividends`).innerText = totalDividends.toFixed(2);
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÏƒÏ…Î½Î¿Î»Î¹ÎºÏÎ½ Ï€Ï‰Î»Î®ÏƒÎµÏ‰Î½
  document.getElementById(`${portfolio}-total-sale-qty`).innerText = totalSaleQty;
  document.getElementById(`${portfolio}-avg-sale-price`).innerText = avgSalePrice.toFixed(2);
  document.getElementById(`${portfolio}-total-sale-value`).innerText = totalSaleValue.toFixed(2);
  document.getElementById(`${portfolio}-total-sale-commissions`).innerText = totalSaleCommissions.toFixed(2);
  document.getElementById(`${portfolio}-total-net-proceeds`).innerText = totalNetProceeds.toFixed(2);
  document.getElementById(`${portfolio}-total-sale-pl`).innerHTML = `<span class="${totalSalePL >= 0 ? 'profit' : 'loss'} bold-pl">${totalSalePL.toFixed(2)}</span>`;
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÏƒÏ…Î½Î¿Î»Î¹ÎºÏÎ½ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏÎ½ Ï€Î¿ÏÏ„Î¿Ï†Î¿Î»Î¯Î¿Ï…
  document.getElementById(`${portfolio}-held-shares`).innerText = heldShares;
  document.getElementById(`${portfolio}-avg-cost-price`).innerText = avgCostPrice.toFixed(2);
  document.getElementById(`${portfolio}-total-cost`).innerText = totalPurchaseCost.toFixed(2);
  document.getElementById(`${portfolio}-current-value`).innerText = totalCurrentValue.toFixed(2);
  document.getElementById(`${portfolio}-total-dividends-sum`).innerText = totalDividends.toFixed(2);
  
  // Bold ÎºÎ­ÏÎ´Î·/Î¶Î·Î¼Î¯ÎµÏ‚ Î¼Îµ Î­Î½Ï„Î¿Î½Î· Î³ÏÎ±Î¼Î¼Î±Ï„Î¿ÏƒÎµÎ¹ÏÎ¬
  const plElement = document.getElementById(`${portfolio}-total-PL`);
  const plPercentElement = document.getElementById(`${portfolio}-total-PLPercent`);
  
  plElement.innerHTML = `<span class="${totalPL >= 0 ? 'final-pl-profit' : 'final-pl-loss'} final-pl">${totalPL.toFixed(2)}</span>`;
  plPercentElement.innerHTML = `<span class="${totalPLPercent >= 0 ? 'final-pl-profit' : 'final-pl-loss'} final-pl">${totalPLPercent.toFixed(2)}%</span>`;
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï€Î»Î®ÏÎ¿Ï…Ï‚ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÎ¿Ï Î±Î½Î¬ Î¼ÎµÏ„Î¿Ï‡Î®
  updateStockHistory(portfolio, stockHistory);
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï€Î»Î®ÏÎ¿Ï…Ï‚ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÎ¿Ï Î³Î¹Î± Ï€Ï‰Î»Î·Î¸ÎµÎ¯ÏƒÎµÏ‚ Î¿Î»ÏŒÎºÎ»Î·ÏÎµÏ‚ Î¼ÎµÏ„Î¿Ï‡Î­Ï‚
  updateSoldStockHistory(portfolio, stockHistory);
  
  // Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·
  savePortfolioData(portfolio);
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÏƒÏÎ½Î¿ÏˆÎ·Ï‚
  updateSummary();
}

// Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï€Î»Î®ÏÎ¿Ï…Ï‚ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÎ¿Ï Î±Î½Î¬ Î¼ÎµÏ„Î¿Ï‡Î®
function updateStockHistory(portfolio, stockHistory) {
  const tbody = document.getElementById(`${portfolio}-stock-history-body`);
  tbody.innerHTML = '';
  
  Object.keys(stockHistory).forEach(stockName => {
    const stock = stockHistory[stockName];
    const heldShares = stock.totalPurchasedQty - stock.totalSoldQty;
    
    // Î ÏÎ¿ÏƒÎ´Î¹Î¿ÏÎ¹ÏƒÎ¼ÏŒÏ‚ ÎºÎ±Ï„Î¬ÏƒÏ„Î±ÏƒÎ·Ï‚
    let status = '';
    let statusClass = '';
    if (heldShares === 0 && stock.totalPurchasedQty > 0) {
      status = 'Î Î©Î›Î—Î˜Î—ÎšÎ• ÎŸÎ›ÎŸÎšÎ›Î—Î¡Î©Î¤Î™ÎšÎ‘';
      statusClass = 'status-sold';
    } else if (heldShares > 0 && stock.totalSoldQty > 0) {
      status = 'ÎœÎ•Î¡Î™ÎšÎ— Î Î©Î›Î—Î£Î—';
      statusClass = 'status-partial';
    } else if (heldShares > 0) {
      status = 'Î•ÎÎ•Î¡Î“Î—';
      statusClass = 'status-active';
    }
    
    // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Ï„ÎµÎ»Î¹ÎºÎ¿Ï ÎºÎ­ÏÎ´Î¿Ï…Ï‚/Î¶Î·Î¼Î¯Î±Ï‚ (Î¼ÏŒÎ½Î¿ Î±Î½ Ï…Ï€Î®ÏÎ¾Î±Î½ Ï€Ï‰Î»Î®ÏƒÎµÎ¹Ï‚)
    let totalPL = 0;
    let totalPLPercent = 0;
    let plDisplay = '-';
    let plPercentDisplay = '-';
    
    if (stock.totalSoldQty > 0) {
      totalPL = stock.totalSaleProceeds + stock.totalDividends - stock.totalPurchaseCost;
      totalPLPercent = stock.totalPurchaseCost > 0 ? (totalPL / stock.totalPurchaseCost * 100) : 0;
      
      plDisplay = `<span class="${totalPL >= 0 ? 'final-pl-profit' : 'final-pl-loss'} final-pl">${totalPL.toFixed(2)}</span>`;
      plPercentDisplay = `<span class="${totalPLPercent >= 0 ? 'final-pl-profit' : 'final-pl-loss'} final-pl">${totalPLPercent.toFixed(2)}%</span>`;
    } else {
      plDisplay = '<span class="no-pl">-</span>';
      plPercentDisplay = '<span class="no-pl">-</span>';
    }
    
    const row = document.createElement('tr');
    if (heldShares === 0) {
      row.classList.add('sold-stock');
    }
    
    row.innerHTML = `
      <td><strong>${stockName}</strong></td>
      <td><span class="stock-status ${statusClass}">${status}</span></td>
      <td>${stock.totalPurchasedQty}</td>
      <td>${stock.totalSoldQty}</td>
      <td>${heldShares}</td>
      <td>${stock.totalPurchaseCost.toFixed(2)}</td>
      <td>${stock.totalDividends.toFixed(2)}</td>
      <td>${stock.totalSaleProceeds.toFixed(2)}</td>
      <td>${plDisplay}</td>
      <td>${plPercentDisplay}</td>
    `;
    
    // Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î¼ÏŒÎ½Î¿ Î±Î½ Î´ÎµÎ½ ÎµÎ¯Î½Î±Î¹ Ï€Î»Î®ÏÏ‰Ï‚ Ï€Ï‰Î»Î·Î¼Î­Î½Î· Î® Î±Î½ ÎµÎ¯Î½Î±Î¹ ÎµÎ½ÎµÏÎ³Î®/Î¼ÎµÏÎ¹ÎºÎ®
    if (heldShares > 0 || stock.totalSoldQty < stock.totalPurchasedQty) {
      tbody.appendChild(row);
    }
  });
}

// Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï€Î»Î®ÏÎ¿Ï…Ï‚ Î¹ÏƒÏ„Î¿ÏÎ¹ÎºÎ¿Ï Î³Î¹Î± Ï€Ï‰Î»Î·Î¸ÎµÎ¯ÏƒÎµÏ‚ Î¿Î»ÏŒÎºÎ»Î·ÏÎµÏ‚ Î¼ÎµÏ„Î¿Ï‡Î­Ï‚
function updateSoldStockHistory(portfolio, stockHistory) {
  const tbody = document.getElementById(`${portfolio}-sold-stock-history-body`);
  tbody.innerHTML = '';
  
  Object.keys(stockHistory).forEach(stockName => {
    const stock = stockHistory[stockName];
    const heldShares = stock.totalPurchasedQty - stock.totalSoldQty;
    
    // Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î¼ÏŒÎ½Î¿ Î±Î½ ÎµÎ¯Î½Î±Î¹ Ï€Î»Î®ÏÏ‰Ï‚ Ï€Ï‰Î»Î·Î¼Î­Î½Î· (100%)
    if (heldShares === 0 && stock.totalPurchasedQty > 0) {
      // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ Ï„ÎµÎ»Î¹ÎºÎ¿Ï ÎºÎ­ÏÎ´Î¿Ï…Ï‚/Î¶Î·Î¼Î¯Î±Ï‚
      const totalPL = stock.totalSaleProceeds + stock.totalDividends - stock.totalPurchaseCost;
      const totalPLPercent = stock.totalPurchaseCost > 0 ? (totalPL / stock.totalPurchaseCost * 100) : 0;
      
      const row = document.createElement('tr');
      row.classList.add('fully-sold-row');
      
      row.innerHTML = `
        <td><strong>${stockName}</strong></td>
        <td>${stock.totalPurchasedQty}</td>
        <td>${stock.totalSoldQty}</td>
        <td>${stock.totalPurchaseCost.toFixed(2)}</td>
        <td>${stock.totalDividends.toFixed(2)}</td>
        <td>${stock.totalSaleProceeds.toFixed(2)}</td>
        <td><span class="${totalPL >= 0 ? 'final-pl-profit' : 'final-pl-loss'} final-pl">${totalPL.toFixed(2)}</span></td>
        <td><span class="${totalPLPercent >= 0 ? 'final-pl-profit' : 'final-pl-loss'} final-pl">${totalPLPercent.toFixed(2)}%</span></td>
      `;
      
      tbody.appendChild(row);
    }
  });
}

// Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· ÏƒÏÎ½Î¿ÏˆÎ·Ï‚ ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Ï€Î¿ÏÏ„Î¿Ï†Î¿Î»Î¯Ï‰Î½
function updateSummary() {
  const allStocksByOwner = {};
  const allStocksByName = {};
  
  portfolios.forEach(portfolio => {
    const heldShares = parseInt(document.getElementById(`${portfolio}-held-shares`).innerText) || 0;
    const totalCost = parseFloat(document.getElementById(`${portfolio}-total-cost`).innerText) || 0;
    const totalNetProceeds = parseFloat(document.getElementById(`${portfolio}-total-net-proceeds`).innerText) || 0;
    const currentValue = parseFloat(document.getElementById(`${portfolio}-current-value`).innerText) || 0;
    const totalDividends = parseFloat(document.getElementById(`${portfolio}-total-dividends-sum`).innerText) || 0;
    const totalPL = parseFloat(document.getElementById(`${portfolio}-total-PL`).innerText) || 0;
    const totalPLPercent = parseFloat(document.getElementById(`${portfolio}-total-PLPercent`).innerText) || 0;
    
    // Î£Ï…Î»Î»Î¿Î³Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î³Î¹Î± ÏƒÏÎ½Î¿Î»Î¿ Î¼ÎµÏ„Î¿Ï‡ÏÎ½ Î±Î½Î¬ ÎºÎ¬Ï„Î¿Ï‡Î¿
    allStocksByOwner[portfolio] = {
      name: portfolio.toUpperCase(),
      uniqueStocks: 0,
      heldShares: heldShares,
      totalCost: totalCost,
      currentValue: currentValue
    };
    
    // Î£Ï…Î»Î»Î¿Î³Î® Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î±Ï€ÏŒ Ï„Î¹Ï‚ Î±Î³Î¿ÏÎ­Ï‚ Î³Î¹Î± ÏƒÏ„Î±Ï„Î¹ÏƒÏ„Î¹ÎºÎ¬ Î±Î½Î¬ Î¼ÎµÏ„Î¿Ï‡Î®
    const purchaseRows = document.querySelectorAll(`#${portfolio}-purchases tbody tr`);
    const stockSet = new Set();
    
    purchaseRows.forEach(row => {
      const stockName = row.querySelector('.stock-name').value.trim();
      if (stockName) {
        stockSet.add(stockName);
        
        // Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÏƒÏ„Î¿ ÏƒÏ…Î½Î¿Î»Î¹ÎºÏŒ Î±Î½Î¬ Î¼ÎµÏ„Î¿Ï‡Î® - Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î¬ Î³Î¹Î± ÎºÎ¬Î¸Îµ ÎºÎ¬Ï„Î¿Ï‡Î¿
        const key = `${stockName}_${portfolio}`;
        const qty = Number(row.querySelector('.purchase-qty').value) || 0;
        const totalCostCell = row.querySelector('.totalCost');
        const totalCostForStock = parseFloat(totalCostCell.innerText) || 0;
        const currentValueCell = row.querySelector('.currentValue');
        const currentValueForStock = parseFloat(currentValueCell.innerText) || 0;
        const dividend = Number(row.querySelector('.dividend').value) || 0;
        
        allStocksByName[key] = {
          stockName: stockName,
          owner: portfolio,
          qty: qty,
          totalCost: totalCostForStock,
          currentValue: currentValueForStock,
          dividend: dividend
        };
      }
    });
    
    allStocksByOwner[portfolio].uniqueStocks = stockSet.size;
    
    document.getElementById(`summary-${portfolio}-held`).innerText = heldShares;
    document.getElementById(`summary-${portfolio}-cost`).innerText = totalCost.toFixed(2);
    document.getElementById(`summary-${portfolio}-proceeds`).innerText = totalNetProceeds.toFixed(2);
    document.getElementById(`summary-${portfolio}-current`).innerText = currentValue.toFixed(2);
    document.getElementById(`summary-${portfolio}-dividends`).innerText = totalDividends.toFixed(2);
    
    // Bold ÎºÎ­ÏÎ´Î·/Î¶Î·Î¼Î¯ÎµÏ‚ Î¼Îµ Î­Î½Ï„Î¿Î½Î· Î³ÏÎ±Î¼Î¼Î±Ï„Î¿ÏƒÎµÎ¹ÏÎ¬
    const plElement = document.getElementById(`summary-${portfolio}-pl`);
    const plPercentElement = document.getElementById(`summary-${portfolio}-plpercent`);
    
    plElement.innerHTML = `<span class="${totalPL >= 0 ? 'final-pl-profit' : 'final-pl-loss'} final-pl">${totalPL.toFixed(2)}</span>`;
    plPercentElement.innerHTML = `<span class="${totalPLPercent >= 0 ? 'final-pl-profit' : 'final-pl-loss'} final-pl">${totalPLPercent.toFixed(2)}%</span>`;
  });
  
  // Î¥Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚ ÏƒÏ…Î½Î¿Î»Î¹ÎºÏÎ½
  let totalHeldAll = 0;
  let totalCostAll = 0;
  let totalProceedsAll = 0;
  let currentValueAll = 0;
  let totalDividendsAll = 0;
  let totalPLAll = 0;
  
  portfolios.forEach(portfolio => {
    totalHeldAll += parseInt(document.getElementById(`summary-${portfolio}-held`).innerText) || 0;
    totalCostAll += parseFloat(document.getElementById(`summary-${portfolio}-cost`).innerText) || 0;
    totalProceedsAll += parseFloat(document.getElementById(`summary-${portfolio}-proceeds`).innerText) || 0;
    currentValueAll += parseFloat(document.getElementById(`summary-${portfolio}-current`).innerText) || 0;
    totalDividendsAll += parseFloat(document.getElementById(`summary-${portfolio}-dividends`).innerText) || 0;
    totalPLAll += parseFloat(document.getElementById(`summary-${portfolio}-pl`).innerText) || 0;
  });
  
  const totalPLPercentAll = totalCostAll > 0 ? (totalPLAll / totalCostAll * 100) : 0;
  
  document.getElementById('summary-total-held').innerText = totalHeldAll;
  document.getElementById('summary-total-cost').innerText = totalCostAll.toFixed(2);
  document.getElementById('summary-total-proceeds').innerText = totalProceedsAll.toFixed(2);
  document.getElementById('summary-total-current').innerText = currentValueAll.toFixed(2);
  document.getElementById('summary-total-dividends').innerText = totalDividendsAll.toFixed(2);
  
  // Bold ÎºÎ­ÏÎ´Î·/Î¶Î·Î¼Î¯ÎµÏ‚ Î¼Îµ Î­Î½Ï„Î¿Î½Î· Î³ÏÎ±Î¼Î¼Î±Ï„Î¿ÏƒÎµÎ¹ÏÎ¬ Î³Î¹Î± Ï„Î¿ ÏƒÏÎ½Î¿Î»Î¿
  const totalPlElement = document.getElementById('summary-total-pl');
  const totalPlPercentElement = document.getElementById('summary-total-plpercent');
  
  totalPlElement.innerHTML = `<span class="${totalPLAll >= 0 ? 'final-pl-profit' : 'final-pl-loss'} final-pl">${totalPLAll.toFixed(2)}</span>`;
  totalPlPercentElement.innerHTML = `<span class="${totalPLPercentAll >= 0 ? 'final-pl-profit' : 'final-pl-loss'} final-pl">${totalPLPercentAll.toFixed(2)}%</span>`;
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï€Î¯Î½Î±ÎºÎ± ÏƒÏÎ½Î¿Î»Î¿ Î¼ÎµÏ„Î¿Ï‡ÏÎ½ Î±Î½Î¬ ÎºÎ¬Ï„Î¿Ï‡Î¿
  const ownerTbody = document.getElementById('summary-stocks-by-owner-body');
  ownerTbody.innerHTML = '';
  
  portfolios.forEach(portfolio => {
    const ownerData = allStocksByOwner[portfolio];
    const row = document.createElement('tr');
    
    row.innerHTML = `
      <td><span class="owner-${portfolio}">${ownerData.name}</span></td>
      <td>${ownerData.uniqueStocks}</td>
      <td>${ownerData.heldShares}</td>
      <td>${ownerData.totalCost.toFixed(2)}</td>
      <td>${ownerData.currentValue.toFixed(2)}</td>
    `;
    
    ownerTbody.appendChild(row);
  });
  
  // Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ· Ï€Î¯Î½Î±ÎºÎ± ÏƒÏÎ½Î¿Î»Î¿ Î¼ÎµÏ„Î¿Ï‡ÏÎ½ Î±Î½Î¬ ÏŒÎ½Î¿Î¼Î± Î¼ÎµÏ„Î¿Ï‡Î®Ï‚
  const nameTbody = document.getElementById('summary-stocks-by-name-body');
  nameTbody.innerHTML = '';
  
  // ÎŸÎ¼Î±Î´Î¿Ï€Î¿Î¯Î·ÏƒÎ· Î¼ÎµÏ„Î¿Ï‡ÏÎ½ Î±Î½Î¬ ÏŒÎ½Î¿Î¼Î± ÎºÎ±Î¹ ÎºÎ¬Ï„Î¿Ï‡Î¿ (Î¾ÎµÎºÎ¹Î½Î¬Î¼Îµ Î¼Îµ Î´Î¹Î±Ï‡Ï‰ÏÎ¹ÏƒÎ¼ÏŒ)
  const stocksByOwnerAndName = {};
  
  Object.keys(allStocksByName).forEach(key => {
    const stockData = allStocksByName[key];
    const ownerKey = stockData.owner;
    const stockName = stockData.stockName;
    
    if (!stocksByOwnerAndName[ownerKey]) {
      stocksByOwnerAndName[ownerKey] = {};
    }
    
    if (!stocksByOwnerAndName[ownerKey][stockName]) {
      stocksByOwnerAndName[ownerKey][stockName] = {
        stockName: stockName,
        owner: ownerKey,
        totalQty: 0,
        totalCost: 0,
        totalCurrentValue: 0,
        totalDividend: 0
      };
    }
    
    stocksByOwnerAndName[ownerKey][stockName].totalQty += stockData.qty;
    stocksByOwnerAndName[ownerKey][stockName].totalCost += stockData.totalCost;
    stocksByOwnerAndName[ownerKey][stockName].totalCurrentValue += stockData.currentValue;
    stocksByOwnerAndName[ownerKey][stockName].totalDividend += stockData.dividend;
  });
  
  // Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÏƒÏ„Î¿Î¹Ï‡ÎµÎ¯Ï‰Î½ ÏƒÏ„Î¿Î½ Ï€Î¯Î½Î±ÎºÎ± - Î¾ÎµÏ‡Ï‰ÏÎ¹ÏƒÏ„Î¬ Î³ÏÎ±Î¼Î¼Î® Î³Î¹Î± ÎºÎ¬Î¸Îµ ÎºÎ¬Ï„Î¿Ï‡Î¿
  Object.keys(stocksByOwnerAndName).forEach(ownerKey => {
    const ownerStocks = stocksByOwnerAndName[ownerKey];
    
    Object.keys(ownerStocks).forEach(stockName => {
      const stockData = ownerStocks[stockName];
      const row = document.createElement('tr');
      
      let ownerDisplay = '';
      if (ownerKey === 'mitsos') {
        ownerDisplay = '<span class="owner-mitsos">ÎœÎ—Î¤Î£ÎŸÎ£</span>';
      } else if (ownerKey === 'aderfoula') {
        ownerDisplay = '<span class="owner-aderfoula">Î‘Î”Î•Î¡Î¦ÎŸÎ¥Î›Î‘</span>';
      } else if (ownerKey === 'father') {
        ownerDisplay = '<span class="owner-father">FATHER</span>';
      }
      
      row.innerHTML = `
        <td><strong>${stockData.stockName}</strong></td>
        <td>${ownerDisplay}</td>
        <td>${stockData.totalQty}</td>
        <td>${stockData.totalCost.toFixed(2)}</td>
        <td>${stockData.totalCurrentValue.toFixed(2)}</td>
        <td>${stockData.totalDividend.toFixed(2)}</td>
      `;
      
      nameTbody.appendChild(row);
    });
  });
}

// Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï€Î¿ÏÏ„Î¿Ï†Î¿Î»Î¯Î¿Ï…
 function savePortfolioData(portfolio) {
  console.log(`ğŸ”§ ÎšÎ›Î—Î˜Î—ÎšÎ• Î· savePortfolioData Î³Î¹Î± ${portfolio}`);
  const data = {
    purchases: [],
    sales: [] 
};
  
  // Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Î±Î³Î¿ÏÏÎ½
  document.querySelectorAll(`#${portfolio}-purchases tbody tr`).forEach(row => {
  console.log(`ğŸ“¥ Î’ÏÎ®ÎºÎ± Î³ÏÎ±Î¼Î¼Î® Î±Î³Î¿ÏÎ¬Ï‚, inputs: ${row.querySelectorAll('input').length}`);
  const inputs = row.querySelectorAll('input');
    
    // ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î±Î½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î±ÏÎºÎµÏ„Î¬ inputs (12 inputs ÏƒÏ…Î½Î¿Î»Î¹ÎºÎ¬)
    if (inputs.length >= 8) {  // Î‘Ï€ÏŒ 11 ÏƒÎµ 8
      data.purchases.push({
        date: inputs[0]?.value || '',
        name: inputs[1]?.value || '',
        qty: inputs[2]?.value || '0',
        buyPrice: inputs[3]?.value || '0.00',
        commission: inputs[5]?.value || '',
        currentPrice: inputs[7]?.value || '0.00',
        dividendDate: inputs[9]?.value || '',
        dividend: inputs[10]?.value || '0.00'
      });
    }
  });
  
  // Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· Ï€Ï‰Î»Î®ÏƒÎµÏ‰Î½
  document.querySelectorAll(`#${portfolio}-sales tbody tr`).forEach(row => {
  console.log(`ğŸ“¤ Î’ÏÎ®ÎºÎ± Î³ÏÎ±Î¼Î¼Î® Ï€ÏÎ»Î·ÏƒÎ·Ï‚, inputs: ${row.querySelectorAll('input').length}`);
  const inputs = row.querySelectorAll('input');
    
    // ÎˆÎ»ÎµÎ³Ï‡Î¿Ï‚ Î±Î½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î±ÏÎºÎµÏ„Î¬ inputs (6 inputs ÏƒÏ…Î½Î¿Î»Î¹ÎºÎ¬)
    if (inputs.length >= 5) {  // Î‘Ï€ÏŒ 6 ÏƒÎµ 5
      data.sales.push({
        date: inputs[0]?.value || '',
        name: inputs[1]?.value || '',
        qty: inputs[2]?.value || '0',
        salePrice: inputs[3]?.value || '0.00',
        commission: inputs[5]?.value || ''
      });
    }
  });
  
  console.log(`ğŸ’¾ Î‘Î ÎŸÎ˜Î—ÎšÎ•Î¥Î£Î— ${portfolio}: ${data.purchases.length} Î±Î³Î¿ÏÎ­Ï‚, ${data.sales.length} Ï€Ï‰Î»Î®ÏƒÎµÎ¹Ï‚`);
localStorage.setItem(`portfolio_${portfolio}`, JSON.stringify(data));
}
// Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ· ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½
function saveAllData() {
  portfolios.forEach(portfolio => {
    savePortfolioData(portfolio);
  });
  showMessage('âœ… ÎŒÎ»Î± Ï„Î± Ï€Î¿ÏÏ„Î¿Ï†ÏŒÎ»Î¹Î± Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎ±Î½ ÎµÏ€Î¹Ï„Ï…Ï‡ÏÏ‚!');
}

// Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Ï€Î¿ÏÏ„Î¿Ï†Î¿Î»Î¯Î¿Ï…
function loadPortfolioData(portfolio) {
  const data = JSON.parse(localStorage.getItem(`portfolio_${portfolio}`) || '{"purchases":[],"sales":[]}');
  
  // Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Î±Î³Î¿ÏÏÎ½
  data.purchases.forEach(purchase => {
    addPurchaseRow(portfolio, purchase);
  });
  
  // Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Ï€Ï‰Î»Î®ÏƒÎµÏ‰Î½
  data.sales.forEach(sale => {
    addSaleRow(portfolio, sale);
  });
}

// Î•Î½Î±Î»Î»Î±Î³Î® Ï€Î¿ÏÏ„Î¿Ï†Î¿Î»Î¯Î¿Ï…
function switchPortfolio(portfolio) {
  // Î‘Ï€ÏŒÎºÏÏ…ÏˆÎ· ÏŒÎ»Ï‰Î½
  document.querySelectorAll('.portfolio-content').forEach(el => {
    el.classList.add('hidden');
  });
  
  // Î‘Ï€ÎµÎ½ÎµÏÎ³Î¿Ï€Î¿Î¯Î·ÏƒÎ· ÏŒÎ»Ï‰Î½ Ï„Ï‰Î½ ÎºÎ¿Ï…Î¼Ï€Î¹ÏÎ½
  document.querySelectorAll('.portfolio-selector button').forEach(btn => {
    btn.classList.remove('active');
  });
  
  // Î•Î¼Ï†Î¬Î½Î¹ÏƒÎ· ÎµÏ€Î¹Î»ÎµÎ³Î¼Î­Î½Î¿Ï…
  document.getElementById(`${portfolio}-portfolio`).classList.remove('hidden');
  document.getElementById(`btn-${portfolio}`).classList.add('active');
  
  currentPortfolio = portfolio;
  
  // Î•Î¬Î½ ÎµÎ¯Î½Î±Î¹ Î· ÏƒÏÎ½Î¿ÏˆÎ·, ÎµÎ½Î·Î¼Î­ÏÏ‰ÏƒÎ·
  if (portfolio === 'summary') {
    updateSummary();
  }
}

// Î‘ÏÏ‡Î¹ÎºÎ¿Ï€Î¿Î¯Î·ÏƒÎ·
document.addEventListener('DOMContentLoaded', function() {
  // Î¦ÏŒÏÏ„Ï‰ÏƒÎ· Î´ÎµÎ´Î¿Î¼Î­Î½Ï‰Î½ Î³Î¹Î± ÎºÎ¬Î¸Îµ Ï€Î¿ÏÏ„Î¿Ï†ÏŒÎ»Î¹Î¿
  portfolios.forEach(portfolio => {
    loadPortfolioData(portfolio);
  });
  
  // Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· Î±ÏÏ‡Î¹ÎºÏÎ½ Î³ÏÎ±Î¼Î¼ÏÎ½ Î±Î½ ÎµÎ¯Î½Î±Î¹ Î¬Î´ÎµÎ¹Î±
  portfolios.forEach(portfolio => {
    const purchaseRows = document.querySelectorAll(`#${portfolio}-purchases tbody tr`);
    const saleRows = document.querySelectorAll(`#${portfolio}-sales tbody tr`);
    
    if (purchaseRows.length === 0) {
      addPurchaseRow(portfolio);
    }
    if (saleRows.length === 0) {
      addSaleRow(portfolio);
    }
  });
  
  // Î‘ÏÏ‡Î¹ÎºÏŒÏ‚ Ï…Ï€Î¿Î»Î¿Î³Î¹ÏƒÎ¼ÏŒÏ‚
  portfolios.forEach(portfolio => {
    calculatePortfolio(portfolio);
  });
});
</script>

</body>
  </html>
