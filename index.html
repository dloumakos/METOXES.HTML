<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Portfolio ÎœÎµÏ„Î¿Ï‡ÏÎ½</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      margin: 0;
      padding: 20px;
    }
    h1 { text-align: center; }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
      background: #fff;
    }
    th, td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: center;
    }
    th { background: #222; color: #fff; }
    input {
      width: 100%;
      padding: 6px;
    }
    button {
      padding: 10px 15px;
      margin-top: 10px;
      cursor: pointer;
    }
    .summary {
      margin-top: 20px;
      background: #fff;
      padding: 15px;
      font-size: 18px;
    }
  </style>
</head>
<body>

<h1>ğŸ“ˆ Î Î±ÏÎ±ÎºÎ¿Î»Î¿ÏÎ¸Î·ÏƒÎ· ÎœÎµÏ„Î¿Ï‡ÏÎ½</h1>

<button onclick="addRow()">â• Î ÏÎ¿ÏƒÎ¸Î®ÎºÎ· ÎœÎµÏ„Î¿Ï‡Î®Ï‚</button>

<table id="portfolioTable">
  <thead>
    <tr>
      <th>Î£ÏÎ¼Î²Î¿Î»Î¿</th>
      <th>Î¤ÎµÎ¼Î¬Ï‡Î¹Î±</th>
      <th>Î¤Î¹Î¼Î® Î‘Î³Î¿ÏÎ¬Ï‚ (â‚¬)</th>
      <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î¤Î¹Î¼Î® (â‚¬)</th>
      <th>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚ (â‚¬)</th>
      <th>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î± (â‚¬)</th>
      <th>ÎšÎ­ÏÎ´Î¿Ï‚ / Î–Î·Î¼Î¹Î¬ (â‚¬)</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<div class="summary" id="summary"></div>

<canvas id="chart" height="100"></canvas>

<script>
let chart;

function addRow(data = {}) {
  const tbody = document.querySelector('#portfolioTable tbody');
  const row = document.createElement('tr');

  row.innerHTML = `
    <td><input value="${data.symbol || ''}" /></td>
    <td><input type="number" value="${data.qty || 0}" /></td>
    <td><input type="number" value="${data.buy || 0}" /></td>
    <td><input type="number" value="${data.current || 0}" /></td>
    <td class="cost">0</td>
    <td class="value">0</td>
    <td class="pl">0</td>
  `;

  tbody.appendChild(row);
  row.querySelectorAll('input').forEach(i => i.addEventListener('input', calculate));
  calculate();
}

function calculate() {
  let totalCost = 0;
  let totalValue = 0;
  const labels = [];
  const values = [];

  document.querySelectorAll('#portfolioTable tbody tr').forEach(row => {
    const inputs = row.querySelectorAll('input');
    const symbol = inputs[0].value;
    const qty = Number(inputs[1].value);
    const buy = Number(inputs[2].value);
    const current = Number(inputs[3].value);

    const cost = qty * buy;
    const value = qty * current;
    const pl = value - cost;

    row.querySelector('.cost').innerText = cost.toFixed(2);
    row.querySelector('.value').innerText = value.toFixed(2);
    row.querySelector('.pl').innerText = pl.toFixed(2);

    totalCost += cost;
    totalValue += value;

    if (symbol) {
      labels.push(symbol);
      values.push(value);
    }
  });

  document.getElementById('summary').innerHTML = `
    <strong>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÏŒÏƒÏ„Î¿Ï‚:</strong> â‚¬${totalCost.toFixed(2)}<br>
    <strong>Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± Î‘Î¾Î¯Î±:</strong> â‚¬${totalValue.toFixed(2)}<br>
    <strong>Î£Ï…Î½Î¿Î»Î¹ÎºÏŒ ÎšÎ­ÏÎ´Î¿Ï‚/Î–Î·Î¼Î¹Î¬:</strong> â‚¬${(totalValue - totalCost).toFixed(2)}
  `;

  drawChart(labels, values);
  saveData();
}

function drawChart(labels, data) {
  const ctx = document.getElementById('chart');
  if (chart) chart.destroy();

  chart = new Chart(ctx, {
    type: 'bar',
    data: {
      labels,
      datasets: [{ data }]
    }
  });
}

function saveData() {
  const data = [];
  document.querySelectorAll('#portfolioTable tbody tr').forEach(row => {
    const inputs = row.querySelectorAll('input');
    data.push({
      symbol: inputs[0].value,
      qty: inputs[1].value,
      buy: inputs[2].value,
      current: inputs[3].value
    });
  });
  localStorage.setItem('portfolio', JSON.stringify(data));
}

function loadData() {
  const data = JSON.parse(localStorage.getItem('portfolio') || '[]');
  if (data.length === 0) addRow();
  data.forEach(d => addRow(d));
}

loadData();
</script>

</body>
</html>